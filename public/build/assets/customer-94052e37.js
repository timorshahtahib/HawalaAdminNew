import{_ as V,a as g,r as p,o as n,h as a,d as e,k as u,b as d,w as m,t as r,e as C,g as c,v as h,i as w,F as x,l as P,n as k,L as F,c as L}from"../js/app2.js";import{P as D}from"./page-header-48f5a59e.js";import{S as j}from"./sweetalert2.all-649b8bd9.js";import{L as q}from"./loader-7b01d283.js";const A={name:"customerTable",components:{Loader:q},data(){return{customers:[],searchQuery:null,isLoading:!1,notFound:!1,showModal:!1,submitted:!1,isError:!1,formError:"",name:"",phoneError:"",phone:"",email:"",password:"",image:null,address:"",desc:"",errors:{},editCust:{},editshowModal:!1,editname:"",editemail:"",editPassword:"",editPhone:"",editImage:null,editAddress:"",editDesc:"",editphoneError:"",currentPage:1,totalPages:1,limit:10}},mounted(){this.getCustomers()},methods:{async getCustomers(l=1){var s;this.isLoading=!0;try{const _=await g.get(`/customer?page=${l}&limit=${this.limit}`);this.customers=_.data.customers.data,this.totalPages=(s=_.data.customers)==null?void 0:s.last_page,this.currentPage=l}catch(_){console.error("Error fetching customers:",_)}finally{this.isLoading=!1}},prevPage(){this.currentPage>1&&this.getCustomers(this.currentPage-1)},nextPage(){this.currentPage<this.totalPages&&this.getCustomers(this.currentPage+1)},editHandleFileChange(l){const s=l.target.files[0];this.editImage=s.name},openModal(){this.showModal=!0},closeModal(){this.showModal=!1,this.name="",this.phone="",this.email="",this.password="",this.image=null,this.address="",this.desc=""},handleFileChange(l){const s=l.target.files[0];this.image=s.name},openEditModal(){this.editshowModal=!0},showalert(l,s,_){j.fire({title:l,text:s,icon:_,confirmButtonText:"بستن"})},async storeCustomer(){if(this.submitted=!0,this.name&&this.phone&&this.email&&this.password){const l=await g.post("/customer",{name:this.name,email:this.email,password:this.password,phone:this.phone,image:this.image,address:this.address,desc:this.desc});l.data!=null&&(l.data.status===!1?l.data.message!=null?this.showalert(l.data.message,"error","error!"):this.errors=l.data.error:(this.errors={},this.name="",this.phone="",this.email="",this.password="",this.image=null,this.address="",this.desc="",this.showModal=!1,this.customers.unshift(l.data.new_data),this.showalert("مشتری با موفقیت ثبت شد!","موفقانه","success")))}else this.isError=!0,this.formError="فیلد ها خالی است"},async editCustomer(l){const s=await g.get(`/customer/${l}`);this.editCust=s.data,this.openEditModal(),this.editname=this.editCust.name,this.editPhone=this.editCust.phone,this.editImage=this.editCust.image,this.editAddress=this.editCust.address,this.editDesc=this.editCust.desc},async editSubmitCustomerForm(){const l=await g.post("/updatecustomer",{id:this.editCust.id,name:this.editname,phone:this.editPhone,image:this.editImage,address:this.editAddress,desc:this.editDesc});l.data!=null&&(l.data.status===!1?l.data.message!=null?this.showalert(l.data.message,"بستن","error"):(this.errors=l.data.error,this.showalert(this.errors,"error","error")):(this.errors={},this.editname="",this.editPhone=null,this.image=null,this.editAddress=null,this.editImage=null,this.editshowModal=!1,this.getCustomers(),this.showalert("مشتری با موفقیت ویرایش شد!","موفقانه","success")))},async deleteCustomer(l){if(window.confirm("آیا میخواهید که مشتری حذف شود؟"))try{const s=await g.delete(`/customer/${l}`);this.customers=s.data,s.status===204&&(this.getCustomers(),this.showalert("مشتری با موفقیت حذف شد!","موفقانه","success"))}catch{this.showalert("مشتری با موفقیت حذف نشد!","ناموفقانه","error")}else return},async searchData(){try{const l=await g.post("/searchCustomer",{query:this.searchQuery});this.customers=l.data,this.notFound=this.customers.length===0}catch(l){console.log(l.message)}},phoneValidation(l){l==="editPhone"&&(this.editPhone===""?this.editphoneError="شماره تماس ضروری است":this.editPhone.length<10?(this.editphoneError="شماره تماس باید حداقل 10 کاراکتر باشد.",this.telephoneCheck(this.editPhone)):this.editphoneError=null)},telephoneCheck(l){/^(1\s|1|)?((\(\d{3}\))|\d{3})(\-|\s)?(\d{3})(\-|\s)?(\d{4})$/.test(l)?this.editphoneError=null:this.editphoneError="لطفا شماره تماس وارد نمائید!"}}},I={class:"col-sm-12"},S={class:"text-sm-end"},B=e("i",{class:"mdi mdi-plus me-1"},null,-1),T={class:"row flex",style:{"justify-content":"center"}},H={class:"row flex justify-between"},N={class:"col-md-12 col-sm-12 col-lg-12"},Q={class:"mb-3"},z=e("label",{for:"name",class:"pr-2"},"نام کامل ",-1),G={class:"row flex justify-between"},J={class:"col-md-6 col-sm-12 col-lg-6"},K={class:"mb-3"},O=e("label",{for:"email"},"ایمیل",-1),R={key:0,class:"text-danger error-text afrad_error"},W={class:"col-sm-12 col-md-6 col-lg-6"},X={class:"mb-3"},Y=e("label",{for:"password"},"رمز عبور",-1),Z={class:"row flex justify-between"},$={class:"col-md-6 col-sm-12 col-lg-6"},ee={class:"mb-3"},se=e("label",{for:"image"},"عکس",-1),te={class:"col-md-6 col-sm-12 col-lg-6"},oe={class:"mb-3"},le=e("label",{for:"phone"},"شماره تماس",-1),ie={key:0,class:"text-danger error-text afrad_error"},re={key:1,class:"text-danger error-text afrad_error"},ne={class:"row col-12"},de={class:"mb-3"},ae=e("label",{for:"address"},"آدرس",-1),ce={class:"row col-12"},he={class:"mb-1"},me=e("label",{for:"desc"},"توضیحات",-1),ue={class:"text-end pt-5 mt-1 g-2"},_e={class:"col-sm-4 bg-red",style:{"margin-top":"-52px"}},pe={class:"search-box me-2 mb-2 d-inline-block"},fe={class:"position-relative"},ge=e("i",{class:"bx bx-search-alt search-icon"},null,-1),be={class:"col-sm-8"},ve={class:"text-sm-end"},we={class:"row flex",style:{"justify-content":"center"}},ye={class:"row"},xe={class:"col-md-12 col-sm-12 col-lg-12"},Ce=e("label",{for:"editname"},"نام کامل",-1),Pe={class:"row flex justify-between"},ke={class:"col-md-6 col-sm-12 col-lg-6"},Ve={class:"mb-3"},Ee=e("label",{for:"editImage"},"عکس",-1),Me={class:"col-md-6 col-sm-12 col-lg-6"},Ue={class:"mb-3"},Fe=e("label",{for:"editPhone"},"شماره تماس",-1),Le={class:"row col-12 juste"},De={class:"mb-3"},je=e("label",{for:"editAddress"},"آدرس",-1),qe={class:"row col-12"},Ae={class:"mb-1"},Ie=e("label",{for:"editDesc"},"توضیحات",-1),Se={class:"text-end pt-5 mt-1 g-2 ml-5"},Be={key:0},Te={key:1,class:"table-responsive"},He={class:"table table-centered table-nowrap"},Ne=e("thead",null,[e("tr",null,[e("th",null,"آیدی"),e("th",null,"نام کامل"),e("th",null,"شماره مسلسل مشتری"),e("th",null,"شماره تماس"),e("th",null,"توضیحات"),e("th",null,"پروفایل کاربر"),e("th",null,"وضیعت"),e("th",null,"اکشن")])],-1),Qe=e("i",{class:"mdi mdi-star me-1"},null,-1),ze={class:"btn btn-xs"},Ge=["onClick"],Je={class:"btn btn-xs"},Ke=["onClick"],Oe={key:0,class:"text-center font-size-20"},Re={class:"pagination pagination-rounded justify-content-center mb-2",style:{}},We={class:"page-item"},Xe=["disabled"],Ye=e("i",{class:"mdi mdi-chevron-left"},null,-1),Ze=[Ye],$e={class:"page-link",href:"javascript: void(0);"},es={class:"page-item"},ss=["disabled"],ts=e("i",{class:"mdi mdi-chevron-right"},null,-1),os=[ts];function ls(l,s,_,E,o,i){const b=p("b-alert"),f=p("b-button"),v=p("b-modal"),M=p("Loader"),U=p("router-link");return n(),a(x,null,[e("div",I,[e("div",S,[e("button",{type:"button",class:"btn btn-success btn-rounded mb-2 me-2",onClick:s[0]||(s[0]=(...t)=>i.openModal&&i.openModal(...t))},[B,u("مشتری جدید ")]),d(v,{modelValue:o.showModal,"onUpdate:modelValue":s[12]||(s[12]=t=>o.showModal=t),title:"اضافه کردن مشتری جدید","title-class":"text-black font-18","body-class":"p-3","hide-footer":""},{default:m(()=>[d(b,{modelValue:o.isError,"onUpdate:modelValue":s[1]||(s[1]=t=>o.isError=t),class:"mb-4",variant:"danger",dismissible:""},{default:m(()=>[u(r(this.formError),1)]),_:1},8,["modelValue"]),e("form",{onSubmit:s[11]||(s[11]=C((...t)=>i.storeCustomer&&i.storeCustomer(...t),["prevent"])),enctype:"multipart/form-data"},[e("div",T,[e("div",H,[e("div",N,[e("div",Q,[z,c(e("input",{id:"name","onUpdate:modelValue":s[2]||(s[2]=t=>o.name=t),type:"text",class:"form-control",placeholder:"نام کامل خود را وارد کنید",onBlur:s[3]||(s[3]=t=>i.phoneValidation("name")),required:""},null,544),[[h,o.name]])])])]),e("div",G,[e("div",J,[e("div",K,[O,c(e("input",{id:"email","onUpdate:modelValue":s[4]||(s[4]=t=>o.email=t),type:"email",class:"form-control",placeholder:" ایمیل خود را وارد کنید",required:""},null,512),[[h,o.email]]),o.errors.email?(n(),a("span",R,r(o.errors.email[0]),1)):w("",!0)])]),e("div",W,[e("div",X,[Y,c(e("input",{id:"password","onUpdate:modelValue":s[5]||(s[5]=t=>o.password=t),type:"password",class:"form-control",placeholder:"رمز خود را واردکنید",required:""},null,512),[[h,o.password]])])])]),e("div",Z,[e("div",$,[e("div",ee,[se,e("input",{type:"file",ref:"image",class:"form-control",onChange:s[6]||(s[6]=(...t)=>i.handleFileChange&&i.handleFileChange(...t))},null,544)])]),e("div",te,[e("div",oe,[le,c(e("input",{type:"text","onUpdate:modelValue":s[7]||(s[7]=t=>o.phone=t),class:"form-control",required:"",onBlur:s[8]||(s[8]=t=>i.phoneValidation("phone"))},null,544),[[h,o.phone]]),o.errors.phone?(n(),a("span",ie,r(o.errors.phone[0]),1)):w("",!0),this.phoneError?(n(),a("span",re,r(this.phoneError),1)):w("",!0)])])]),e("div",ne,[e("div",de,[ae,c(e("textarea",{"onUpdate:modelValue":s[9]||(s[9]=t=>o.address=t),id:"address",cols:"30",rows:"4",class:"form-control",placeholder:"آدرس خود را وارد کنید",required:""},null,512),[[h,o.address]])])]),e("div",ce,[e("div",he,[me,c(e("textarea",{"onUpdate:modelValue":s[10]||(s[10]=t=>o.desc=t),id:"desc",cols:"30",rows:"4",class:"form-control",placeholder:"توضیحات خود را وارد کنید"},null,512),[[h,o.desc]])])])]),e("div",ue,[d(f,{variant:"danger",onClick:i.closeModal},{default:m(()=>[u("بستن")]),_:1},8,["onClick"]),d(f,{type:"submit",variant:"success",class:"ms-1 ml-2"},{default:m(()=>[u("ساختن")]),_:1})])],32)]),_:1},8,["modelValue"])])]),e("div",_e,[e("div",pe,[e("div",fe,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[13]||(s[13]=t=>o.searchQuery=t),placeholder:"جستجوی مشتری...",onInput:s[14]||(s[14]=(...t)=>i.searchData&&i.searchData(...t))},null,544),[[h,o.searchQuery]]),ge])])]),e("div",be,[e("div",ve,[d(v,{modelValue:o.editshowModal,"onUpdate:modelValue":s[23]||(s[23]=t=>o.editshowModal=t),title:"ویرایش مشتری","title-class":"text-black font-18","body-class":"p-3","hide-footer":""},{default:m(()=>[d(b,{modelValue:o.isError,"onUpdate:modelValue":s[15]||(s[15]=t=>o.isError=t),class:"mb-4",variant:"danger",dismissible:""},{default:m(()=>[u(r(this.formError),1)]),_:1},8,["modelValue"]),e("form",{onSubmit:s[22]||(s[22]=C((...t)=>i.editSubmitCustomerForm&&i.editSubmitCustomerForm(...t),["prevent"])),enctype:"multipart/form-data"},[e("div",we,[e("div",ye,[e("div",xe,[Ce,c(e("input",{id:"editname","onUpdate:modelValue":s[16]||(s[16]=t=>o.editname=t),type:"text",class:"form-control",placeholder:"نام کامل خود را وارد کنید",required:""},null,512),[[h,o.editname]])])]),e("div",Pe,[e("div",ke,[e("div",Ve,[Ee,e("input",{type:"file",ref:"editImage",class:"form-control",onChange:s[17]||(s[17]=(...t)=>i.editHandleFileChange&&i.editHandleFileChange(...t))},null,544)])]),e("div",Me,[e("div",Ue,[Fe,c(e("input",{type:"text","onUpdate:modelValue":s[18]||(s[18]=t=>o.editPhone=t),class:"form-control",required:""},null,512),[[h,o.editPhone]])])])]),e("div",Le,[e("div",De,[je,c(e("textarea",{"onUpdate:modelValue":s[19]||(s[19]=t=>o.editAddress=t),id:"editAddress",cols:"30",rows:"4",class:"form-control",placeholder:"آدرس خود را وارد کنید"},null,512),[[h,o.editAddress]])])]),e("div",qe,[e("div",Ae,[Ie,c(e("textarea",{"onUpdate:modelValue":s[20]||(s[20]=t=>o.editDesc=t),id:"editDesc",cols:"30",rows:"4",class:"form-control",placeholder:"توضیحات خود را وارد کنید"},null,512),[[h,o.editDesc]])])])]),e("div",Se,[d(f,{variant:"danger",onClick:s[21]||(s[21]=t=>o.editshowModal=!1)},{default:m(()=>[u("بستن")]),_:1}),d(f,{type:"submit",variant:"success",class:"ms-1 ml-2"},{default:m(()=>[u("آپدیت")]),_:1})])],32)]),_:1},8,["modelValue"])])]),o.isLoading?(n(),a("div",Be,[d(M)])):(n(),a("div",Te,[e("table",He,[Ne,e("tbody",null,[(n(!0),a(x,null,P(o.customers,t=>(n(),a("tr",{key:t.id,style:{}},[e("td",null,r(t.id),1),e("td",null,r(t.name),1),e("td",null,r(t.cu_number),1),e("td",null,r(t.phone),1),e("td",null,r(t.desc),1),e("td",null,[d(U,{class:"btn btn-xs btn-primary",to:`/dashboard/customer/${t.id}`},{default:m(()=>[u("پروفایل")]),_:2},1032,["to"])]),e("td",null,[e("span",{class:k(["badge font-size-12",t.status===0?"bg-warning":"bg-primary"])},[Qe,u(" "+r(t.status),1)],2)]),e("td",null,[e("button",ze,[e("i",{class:"fas fa-pencil-alt text-success me-1",onClick:y=>i.editCustomer(t.id)},null,8,Ge)]),e("button",Je,[e("i",{class:"fas fa-trash-alt text-danger me-1",onClick:y=>i.deleteCustomer(t.id)},null,8,Ke)])])]))),128))])]),o.notFound?(n(),a("div",Oe," نتیجه مورد نظر یافت نشد! ")):w("",!0),e("ul",Re,[e("li",We,[e("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Previous",onClick:s[24]||(s[24]=(...t)=>i.prevPage&&i.prevPage(...t)),disabled:o.currentPage===1},Ze,8,Xe)]),(n(!0),a(x,null,P(o.totalPages,(t,y)=>(n(),a("li",{class:k(["page-item",{active:t===o.currentPage}]),key:y},[e("a",$e,r(t),1)],2))),128)),e("li",es,[e("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Next",onClick:s[25]||(s[25]=(...t)=>i.nextPage&&i.nextPage(...t)),disabled:o.currentPage===o.totalPages},os,8,ss)])])]))],64)}const is=V(A,[["render",ls]]),rs={components:{Layout:F,PageHeader:D,customerTable:is},data(){return{title:"لیست مشتریان",items:[{text:"مشتری",href:"/"},{text:"مشتری",active:!0}]}},methods:{}},ns={class:"row"},ds={class:"col-12"},as={class:"card h-100",style:{"min-height":"100vh"}},cs={class:"card-body"},hs=e("div",{class:"row mb-2"},null,-1);function ms(l,s,_,E,o,i){const b=p("PageHeader"),f=p("customerTable"),v=p("Layout");return n(),L(v,null,{default:m(()=>[d(b,{title:o.title,items:o.items},null,8,["title","items"]),e("div",ns,[e("div",ds,[e("div",as,[e("div",cs,[hs,d(f)])])])])]),_:1})}const gs=V(rs,[["render",ms]]);export{gs as default};
