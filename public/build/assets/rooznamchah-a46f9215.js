import{_ as z,L as F,a as d,c as T,w as M,r as _,o as l,b as h,d as e,g as u,j as f,h as i,l as b,F as v,v as U,t as c,n as V,k as N}from"../js/app2.js";import{P as j}from"./page-header-48f5a59e.js";import"./sweetalert2.all-649b8bd9.js";import{C as B}from"./vue-select-886f034d.js";import{s as q}from"./index-es-d78b0417.js";import{L as A}from"./loader-7b01d283.js";import{E,h as H}from"./jspdf.es.min-1354170b.js";const Q={components:{Layout:F,PageHeader:j,DatePicker:q,vSelect:B,Loader:A},data(){return{title:"لیست  تمام ترانزکشن ها",items:[{text:"جستجوی ترانزکشن ها",href:"/"},{text:"لیست تمام ترانزکشن ها",active:!0}],showModal:!1,searchQuery:"",isLoading:!1,transactions:[],banks:[],transaction_type:"",rasid_bord:"",selectedCustomer:"",currencyModel:"",SelectedDakhl:"",start_date:"",end_date:"",customers:[],currencies:[],currentPage:1,totalPages:1,limit:10}},mounted(){this.getTransaction(),this.transaction_type="all",this.rasid_bord="all"},methods:{select(a){this.start_date=a.toString()},select_end_date(a){this.end_date=a.toString()},async getCustomers(){try{const a=await d.get("/customer");this.customers=a.data.customers.data}catch(a){console.error("Error fetching data: ",a.message)}},async getFinanceAccount(a=1){this.isLoading=!0;try{const s=await d.get(`/finance_account?page=${a}&limit=${this.limit}`);this.banks=s.data.financeAccounts.data,this.totalPages=s.data.financeAccounts.last_page,this.currentPage=a}catch(s){console.error("Error fetching finance Account:",s)}finally{this.isLoading=!1}},async getTransaction(a=1){try{const s=await d.post(`/getrooznamchah?page=${a}&limit=${this.limit}`);this.transactions=s.data.transactions.data,this.currencies=s.data.currencies,this.customers=s.data.customers,this.banks=s.data.financeAccounts,this.totalPages=s.data.transactions.last_page,this.currentPage=a}catch{console.log("مشکلی پیش آمده است")}},prevPage(){this.currentPage>1&&this.getTransaction(this.currentPage-1)},nextPage(){this.currentPage<this.totalPages&&this.getTransaction(this.currentPage+1)},async searchData(){const a=await d.post("/searchtransactions",{query:this.searchQuery});this.transactions=a.data},change_currency(){this.currencyModel?this.getBanks(this.currencyModel):console.log("Error in change_currency")},async getBanks(a){try{const s=await d.get("/getbankbyid/"+a);this.banks=s.data.banks,this.selectedDakhl=this.banks[0].id,console.log("this.banks",this.selectedDakhl)}catch(s){console.log(s.message)}},async filterRooznamchah(){console.log(this.start_date,"s"),console.log(this.end_date,"e");const a=await d.post("/filterrooznamchah",{transaction_type:this.transaction_type,rasid_bord:this.rasid_bord,customer_id:this.selectedCustomer,currency:this.currencyModel,dakhl:this.SelectedDakhl,start_date:this.start_date,end_date:this.end_date});this.transactions=a.data.transactions},displayTransactionType(a){if(a==="rasid_bord")return"رسید برد ";if(a==="exchange")return"تبادله  اسعار";if(a==="expense")return"مصارف";if(a==="transfer")return"انتقال بانکی";if(a==="commission")return"کمیشن"},exportToPDF(){const a=this.$refs.table1,s=new E("p","mm","a4"),y=190,w="../../../../fonts/arial.ttf";s.addFileToVFS("arial.ttf",w),s.setFont("arial"),s.setFontSize(12),H(a).then(o=>{const n=o.toDataURL("image/png"),k=o.height*y/o.width;s.addImage(n,"PNG",10,10,y,k);const m=s.internal.getNumberOfPages();for(let r=1;r<=m;r++){s.setPage(r);const x=`Page ${r} of ${m}`,P=12,g=s.internal.pageSize.getWidth()/2,t=s.internal.pageSize.getHeight()-10;s.setFontSize(P),s.text(x,g,t,{align:"center"})}s.save("rooznamchah.pdf")})}}},R={class:"row"},I={class:"col-12"},W={class:"card"},G={class:"card-body"},O=e("h4",{class:"card-title mb-4"},"جستجوی معامله",-1),X={class:"repeater",enctype:"multipart/form-data"},Y={class:"row"},J={class:"mb-3 col-md-2"},K=e("label",{for:"email"},"نوع معامله",-1),Z=e("option",{value:"all"},"همه",-1),$=e("option",{value:"rasid_bord"},"رسید و بردها",-1),ee=e("option",{value:"exchange"},"تبادلات",-1),te=e("option",{value:"transfer"},"انتقلات",-1),se=e("option",{value:"expense"},"مصارف",-1),oe=e("option",{value:"income"},"درآمدها",-1),ae=e("option",{value:"commission"},"کمیشن",-1),le=[Z,$,ee,te,se,oe,ae],ne={class:"mb-3 col-md-2"},ie=e("label",{for:"email"},"نوع رسید وبرد",-1),ce=e("option",{value:"all"},"همه",-1),re=e("option",{value:"rasid"},"رسید",-1),de=e("option",{value:"bord"},"برد",-1),_e=[ce,re,de],he={class:"mb-3 col-md-4 mt-4 p-2"},ue={class:"col-md-2 col-xs-12"},me=e("label",{for:"supplier"},"واحد پول :",-1),ge=e("option",{disabled:"",selected:""}," واحد",-1),pe=["value"],fe=e("span",{class:"text-danger error-text currency_error"},null,-1),be={class:"col-md-2 col-xs-12"},ve=e("label",{for:"supplier"},"انتخاب دخل : ",-1),ye=e("option",null,"ابتدا واحد پول را انتخاب کنید.",-1),ke=["value"],xe=e("span",{class:"text-danger error-text dakhl_error"},null,-1),Pe={class:"row"},we={class:"mb-3 col-lg-2"},Se=e("label",{for:"email"},"تاریخ شروع",-1),Ce={class:"mb-3 col-lg-2"},De=e("label",{for:"email"},"تاریخ ختم",-1),Le={class:"col-lg-1 align-self-center"},Ve={class:"d-grid"},ze=e("div",{class:"col-xl-4"},[e("div",{class:"card"})],-1),Fe={class:"col-xl-12"},Te={class:"card"},Me={class:"card-body"},Ue={class:"row"},Ne={class:"col-md-10"},je={class:"search-box me-2 mb-2 d-inline-block"},Be={class:"position-relative"},qe=e("i",{class:"bx bx-search-alt search-icon"},null,-1),Ae={class:"col-md-2 flex space-around"},Ee={class:"row"},He={class:"col-sm-12"},Qe={key:0},Re={key:1},Ie={key:0,class:"table-responsive"},We={class:"table table-centered table-nowrap text-start",ref:"table1"},Ge=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"تاریخ"),e("th",{class:"text-center"},"نوع تراکنش"),e("th",{class:"text-center"},"نام مشتری"),e("th",{class:"text-center"},"مقدار پول"),e("th",{class:"text-center"},"تفصیلات"),e("th",{class:"text-center"},"نمبر چک")])],-1),Oe={class:"text-center"},Xe={key:0},Ye={key:1},Je={key:0},Ke={key:1},Ze={class:"pagination pagination-rounded justify-content-center mb-2",style:{}},$e={class:"page-item"},et=["disabled"],tt=e("i",{class:"mdi mdi-chevron-left"},null,-1),st=[tt],ot={class:"page-link",href:"javascript: void(0);"},at={class:"page-item"},lt=["disabled"],nt=e("i",{class:"mdi mdi-chevron-right"},null,-1),it=[nt],ct={key:1,class:"text-center font-size-20"},rt=e("div",{class:"",style:{height:"50vh",display:"flex","flex-direction":"column","justify-content":"center"}}," تراکنشی برای نمایش وجود ندارد! ",-1),dt=[rt];function _t(a,s,y,w,o,n){const k=_("PageHeader"),m=_("v-select"),r=_("date-picker"),x=_("Loader"),P=_("Layout");return l(),T(P,null,{default:M(()=>{var g;return[h(k,{title:o.title,items:o.items},null,8,["title","items"]),e("div",R,[e("div",I,[e("div",W,[e("div",G,[O,e("form",X,[e("div",null,[e("div",Y,[e("div",J,[K,u(e("select",{class:"form-control form-control-lg required","onUpdate:modelValue":s[0]||(s[0]=t=>o.transaction_type=t)},le,512),[[f,o.transaction_type]])]),e("div",ne,[ie,u(e("select",{class:"form-control form-control-lg required","onUpdate:modelValue":s[1]||(s[1]=t=>o.rasid_bord=t)},_e,512),[[f,o.rasid_bord]])]),e("div",he,[h(m,{name:"customerName",modelValue:o.selectedCustomer,"onUpdate:modelValue":s[2]||(s[2]=t=>o.selectedCustomer=t),options:o.customers,label:"name",placeholder:"مشتری مورد نظر خود را سرچ کنید",class:"searchCustomer"},null,8,["modelValue","options"])]),e("div",ue,[me,u(e("select",{class:"form-control form-control-lg select2 required",onChange:s[3]||(s[3]=(...t)=>n.change_currency&&n.change_currency(...t)),"onUpdate:modelValue":s[4]||(s[4]=t=>o.currencyModel=t)},[ge,(l(!0),i(v,null,b(o.currencies,t=>(l(),i("option",{key:t==null?void 0:t.id,value:t==null?void 0:t.id},c(t==null?void 0:t.name)+" "+c(t==null?void 0:t.sign),9,pe))),128))],544),[[f,o.currencyModel]]),fe]),e("div",be,[ve,u(e("select",{class:"form-control form-control-lg select2 required","onUpdate:modelValue":s[5]||(s[5]=t=>o.SelectedDakhl=t)},[ye,(l(!0),i(v,null,b(o.banks,t=>(l(),i("option",{key:t.id,value:t.id},c(t.account_name),9,ke))),128))],512),[[f,o.SelectedDakhl]]),xe])]),e("div",Pe,[e("div",we,[Se,h(r,{modelValue:o.start_date,"onUpdate:modelValue":s[6]||(s[6]=t=>o.start_date=t),mode:"single",type:"date",locale:"fa",column:1,clearable:""},null,8,["modelValue"])]),e("div",Ce,[De,h(r,{onSelect:n.select_end_date,mode:"single",type:"date",locale:"fa",column:1,clearable:""},null,8,["onSelect"])]),e("div",Le,[e("div",Ve,[e("input",{type:"button",class:"btn btn-primary btn-block",value:"جستجو",onClick:s[7]||(s[7]=(...t)=>n.filterRooznamchah&&n.filterRooznamchah(...t))})])])])])])])])]),ze,e("div",Fe,[e("div",Te,[e("div",Me,[e("div",Ue,[e("div",Ne,[e("div",je,[e("div",Be,[u(e("input",{type:"text","onUpdate:modelValue":s[8]||(s[8]=t=>o.searchQuery=t),class:"form-control",placeholder:"جستجوی مشتری...",onInput:s[9]||(s[9]=(...t)=>n.searchData&&n.searchData(...t))},null,544),[[U,o.searchQuery]]),qe])])]),e("div",Ae,[e("button",{class:"btn btn-primary",onClick:s[10]||(s[10]=(...t)=>n.exportToPDF&&n.exportToPDF(...t))},"خروجی گرفتن")])]),e("div",Ee,[e("div",He,[o.isLoading?(l(),i("div",Qe,[h(x)])):(l(),i("div",Re,[(g=o.transactions)!=null&&g.length?(l(),i("div",Ie,[e("table",We,[Ge,e("tbody",Oe,[(l(!0),i(v,null,b(o.transactions,t=>{var p,S,C,D,L;return l(),i("tr",{key:t==null?void 0:t.id},[e("td",null,c(t==null?void 0:t.date),1),e("td",null,[e("span",{class:V(["badge badge-pill badge-soft-success font-bold p-2",{"badge-soft-success":`${t.rasid_bord}`=="rasid","badge-soft-warning":`${t.rasid_bord}`=="bord"}])},c(n.displayTransactionType(t.transaction_type)),3)]),t.customer!=null?(l(),i("td",Xe,c((p=t.customer)==null?void 0:p.name),1)):(l(),i("td",Ye,c((S=t.finance_account)==null?void 0:S.account_name),1)),e("td",null,[N(c(t.amount.toLocaleString())+" "+c((C=t.tr_currency)==null?void 0:C.name)+" "+c(t.rasid_bord==="rasid"?"به":"از")+" ",1),(t==null?void 0:t.bank_account)!=null?(l(),i("span",Je,c((D=t.bank_account)==null?void 0:D.account_name),1)):(l(),i("span",Ke,c((L=t.finance_account)==null?void 0:L.account_name),1))]),e("td",null,c(t.desc),1),e("td",null,c(t.check_number),1)])}),128))])],512),e("ul",Ze,[e("li",$e,[e("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Previous",onClick:s[11]||(s[11]=(...t)=>n.prevPage&&n.prevPage(...t)),disabled:o.currentPage===1},st,8,et)]),(l(!0),i(v,null,b(o.totalPages,(t,p)=>(l(),i("li",{class:V(["page-item",{active:t===o.currentPage}]),key:p},[e("a",ot,c(t),1)],2))),128)),e("li",at,[e("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Next",onClick:s[12]||(s[12]=(...t)=>n.nextPage&&n.nextPage(...t)),disabled:o.currentPage===o.totalPages},it,8,lt)])])])):(l(),i("div",ct,dt))]))])])])])])])]}),_:1})}const vt=z(Q,[["render",_t]]);export{vt as default};
