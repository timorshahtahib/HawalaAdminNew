import{_ as y,a as c,r as u,o as i,h as o,d as t,g as x,v as P,b as m,F as g,l as f,t as s,n as p,k as w,L as k,c as L,w as O}from"../js/app2.js";import{P as C}from"./page-header-48f5a59e.js";import{S}from"./sweetalert2.all-8f9540fb.js";import{L as M}from"./loader-7b01d283.js";const T={name:"orderTable",components:{Loader:M},data(){return{isLoading:!1,orders:[],searchQuery:"",currentPage:1,totalPages:1,limit:10}},mounted(){this.getOrders()},methods:{showalert(a,l,h){S.fire({title:a,text:l,icon:h,confirmButtonText:"خوب"})},async getOrders(a=1){this.isLoading=!0;try{const l=await c.get(`/orders?page=${a}&limit=${this.limit}`);this.orders=l.data.orders.data,this.totalPages=l.data.orders.last_page,this.currentPage=a}catch(l){console.error("Error fetching orders:",l)}finally{this.isLoading=!1}},prevPage(){this.currentPage>1&&this.getOrders(this.currentPage-1)},nextPage(){this.currentPage<this.totalPages&&this.getOrders(this.currentPage+1)},openEditModal(){this.showModal=!0,console.log("openEditModal",this.editCust)},closeModal(){this.showModal=!1},async editOrder(a){const l=await c.get(`/orders/${a}`);this.editord=l.data,this.openEditModal(this.editord),this.editOrderState=this.editord.state,this.editPhone=this.editord.phone_number,this.editQtt=this.editord.qtt},async editSubmitOrder(){},async deleteOrder(a){if(window.confirm("آیا میخواهید که سفارش حذف شود؟"))try{console.log("inside try");const l=await c.delete(`/orders/${a}`);this.orders=l.data,l.status===204&&(this.showalert("سفارش با موفقیت حذف شد!","ادامه دهید","success"),this.getOrders())}catch{console.log("inside catch"),this.showalert("سفارش با موفقیت حذف نشد!","ادامه دهید","error")}else return},async searchData(){const a=await c.post("/searchorder",{query:this.searchQuery});this.orders=a.data}}},j={class:"col-sm-4 bg-red",style:{"margin-top":"-52px"}},B={class:"search-box me-2 mb-2 d-inline-block"},D={class:"position-relative"},E=t("i",{class:"bx bx-search-alt search-icon"},null,-1),Q={key:0},z={key:1},N={key:0,class:"table-responsive"},V={class:"table table-centered table-nowrap"},q=t("thead",null,[t("tr",null,[t("th",null,"آیدی"),t("th",null,"آیدی مشتری"),t("th",null,"آیدی ترانزکشن"),t("th",null,"تاریخ سفارش"),t("th",null,"تاریخ اجرا"),t("th",null,"حالت"),t("th",null,"شماره سفارش"),t("th",null,"سیستم"),t("th",null,"شماره تماس"),t("th",null,"سب کتگوری آیدی"),t("th",null,"کیو تی تی"),t("th",null,"مقدار"),t("th",null,"مقدار نهائی"),t("th",null,"درصد مفاد"),t("th",null,"مبلغ مفاد"),t("th",null,"واحد پولی"),t("th",null,"آیدی ارز خریدار"),t("th",null,"نرخ ارز"),t("th",null,"قیمت خرید"),t("th",null,"آیدی یوزر"),t("th",null,"آیدی محصول"),t("th",null,"آیدی تامین کننده"),t("th",null,"توضیح رد شده"),t("th",null,"وضعیت"),t("th",null,"اکشن")])],-1),H=t("i",{class:"mdi mdi-star me-1"},null,-1),F={class:"btn btn-xs"},I=["onClick"],U={class:"pagination pagination-rounded justify-content-center mb-2",style:{}},$={class:"page-item"},A=["disabled"],G=t("i",{class:"mdi mdi-chevron-left"},null,-1),J=[G],K={class:"page-link",href:"javascript: void(0);"},R={class:"page-item"},W=["disabled"],X=t("i",{class:"mdi mdi-chevron-right"},null,-1),Y=[X],Z={key:1,class:"text-center font-size-20"};function tt(a,l,h,v,n,r){var d;const _=u("Loader");return i(),o(g,null,[t("div",j,[t("div",B,[t("div",D,[x(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[0]||(l[0]=e=>n.searchQuery=e),placeholder:"جستجوی مشتری...",onInput:l[1]||(l[1]=(...e)=>r.searchData&&r.searchData(...e))},null,544),[[P,n.searchQuery]]),E])])]),n.isLoading?(i(),o("div",Q,[m(_)])):(i(),o("div",z,[(d=n.orders)!=null&&d.length?(i(),o("div",N,[t("table",V,[q,t("tbody",null,[(i(!0),o(g,null,f(n.orders,e=>(i(),o("tr",{key:e.id},[t("td",null,s(e.id),1),t("td",null,s(e.customer_id),1),t("td",null,s(e.transaction_id),1),t("td",null,s(e.order_date),1),t("td",null,s(e.action_date),1),t("td",null,[t("span",{class:p(["badge badge-pill font-bold p-2 font-size-12",e.state==="done"?"badge-soft-success":e.state==="pending"?"badge-soft-warning":"badge-soft-danger"])},s(e.state),3)]),t("td",null,s(e.order_number),1),t("td",null,s(e.system),1),t("td",null,s(e.phone_number),1),t("td",null,s(e.sub_category_id),1),t("td",null,s(e.qtt),1),t("td",null,s(e.amount.toLocaleString()),1),t("td",null,s(e.final_amount.toLocaleString()),1),t("td",null,s(e.profit_percentage),1),t("td",null,s(e.profit_amount.toLocaleString()),1),t("td",null,s(e.currency),1),t("td",null,s(e.buy_currency_id),1),t("td",null,s(e.currency_rate),1),t("td",null,s(e.buy_price),1),t("td",null,s(e.user_id),1),t("td",null,s(e.product_id),1),t("td",null,s(e.supplier_id),1),t("td",null,s(e.reject_disc),1),t("td",null,[t("span",{class:p(["badge font-size-12",e.status===0?"bg-warning":"bg-primary"])},[H,w(" "+s(e.status),1)],2)]),t("td",null,[t("button",F,[t("i",{class:"fas fa-trash-alt text-danger me-1",onClick:b=>r.deleteOrder(e.id)},null,8,I)])])]))),128))])]),t("ul",U,[t("li",$,[t("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Previous",onClick:l[2]||(l[2]=(...e)=>r.prevPage&&r.prevPage(...e)),disabled:n.currentPage===1},J,8,A)]),(i(!0),o(g,null,f(n.totalPages,(e,b)=>(i(),o("li",{class:p(["page-item",{active:e===n.currentPage}]),key:b},[t("a",K,s(e),1)],2))),128)),t("li",R,[t("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Next",onClick:l[3]||(l[3]=(...e)=>r.nextPage&&r.nextPage(...e)),disabled:n.currentPage===n.totalPages},Y,8,W)])])])):(i(),o("div",Z," نتیجه مورد نظر یافت نشد! "))]))],64)}const et=y(T,[["render",tt]]),st={components:{Layout:k,PageHeader:C,orderTable:et},data(){return{title:"لیست همه سفارشات",items:[{text:"داشبورد",href:"/"},{text:"سفارشات",active:!0}]}},methods:{}},lt={class:"row"},nt={class:"col-12"},at={class:"card",style:{"min-height":"100vh !important"}},it={class:"card-body"},ot=t("div",{class:"row mb-2"},[t("div",{class:"col-sm-4"},[t("div",{class:"search-box me-2 mb-2 d-inline-block"},[t("div",{class:"position-relative"},[t("input",{type:"text",class:"form-control",placeholder:"جستجوی سفارش..."}),t("i",{class:"bx bx-search-alt search-icon"})])])])],-1);function rt(a,l,h,v,n,r){const _=u("PageHeader"),d=u("orderTable"),e=u("Layout");return i(),L(e,null,{default:O(()=>[m(_,{title:n.title,items:n.items},null,8,["title","items"]),t("div",lt,[t("div",nt,[t("div",at,[t("div",it,[ot,m(d)])])])])]),_:1})}const _t=y(st,[["render",rt]]);export{_t as default};
