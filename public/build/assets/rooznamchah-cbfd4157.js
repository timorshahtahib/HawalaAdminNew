import{_ as z,L as F,a as d,c as T,w as M,r as _,o as l,b as h,d as e,g as u,j as f,h as i,l as b,F as v,v as U,t as r,n as V,k as E}from"../js/app2.js";import{P as N}from"./page-header-48f5a59e.js";import"./sweetalert2.all-8f9540fb.js";import{C as j}from"./vue-select-1fb2a2bb.js";import{s as B}from"./index-es-db6441bd.js";import{L as q}from"./loader-7b01d283.js";import{E as A,h as H}from"./jspdf.es.min-99e08454.js";const Q={components:{Layout:F,PageHeader:N,DatePicker:B,vSelect:j,Loader:q},data(){return{title:"لیست  تمام ترانزکشن ها",items:[{text:"جستجوی ترانزکشن ها",href:"/"},{text:"لیست تمام ترانزکشن ها",active:!0}],showModal:!1,searchQuery:"",isLoading:!1,transactions:[],banks:[],transaction_type:"",rasid_bord:"",selectedCustomer:"",currencyModel:"",SelectedDakhl:"",start_date:"",end_date:"",customers:[],currencies:[],currentPage:1,totalPages:1,limit:10}},mounted(){this.getTransaction(),this.transaction_type="all",this.rasid_bord="all"},methods:{select(o){this.start_date=o.toString()},select_end_date(o){this.end_date=o.toString()},async getCustomers(){try{const o=await d.get("/customer");this.customers=o.data.customers.data}catch(o){console.error("Error fetching data: ",o.message)}},async getCurrency(){try{await d.get("/currencies").then(o=>{this.currencies=o.data.currencies.data}).catch(o=>{console.error("Error fetching currencies:",o)})}catch(o){console.error("Error fetching data: ",o.message)}},async getFinanceAccount(o=1){this.isLoading=!0;try{const s=await d.get(`/finance_account?page=${o}&limit=${this.limit}`);this.banks=s.data.financeAccounts.data,this.totalPages=s.data.financeAccounts.last_page,this.currentPage=o}catch(s){console.error("Error fetching finance Account:",s)}finally{this.isLoading=!1}},async getTransaction(o=1){const s=await d.post(`/getrooznamchah?page=${o}&limit=${this.limit}`,{current_date:"1402/11/25"});this.transactions=s.data.transactions.data,this.currencies=s.data.currencies,this.customers=s.data.customers,this.banks=s.data.financeAccounts,this.totalPages=s.data.transactions.last_page,this.currentPage=o},prevPage(){this.currentPage>1&&this.getTransaction(this.currentPage-1)},nextPage(){this.currentPage<this.totalPages&&this.getTransaction(this.currentPage+1)},async searchData(){const o=await d.post("/searchtransactions",{query:this.searchQuery});this.transactions=o.data},change_currency(){this.currencyModel?this.getBanks(this.currencyModel):console.log("Error in change_currency")},async getBanks(o){try{const s=await d.get("/getbankbyid/"+o);this.banks=s.data.banks,this.selectedDakhl=this.banks[0].id,console.log("this.banks",this.selectedDakhl)}catch(s){console.log(s.message)}},async filterRooznamchah(){console.log(this.start_date,"s"),console.log(this.end_date,"e");const o=await d.post("/filterrooznamchah",{transaction_type:this.transaction_type,rasid_bord:this.rasid_bord,customer_id:this.selectedCustomer,currency:this.currencyModel,dakhl:this.SelectedDakhl,start_date:this.start_date,end_date:this.end_date});this.transactions=o.data.transactions},displayTransactionType(o){if(o==="rasid_bord")return"رسید برد ";if(o==="exchange")return"تبادله  اسعار";if(o==="expense")return"مصارف";if(o==="transfer")return"انتقال بانکی";if(o==="commission")return"کمیشن"},exportToPDF(){const o=this.$refs.table1,s=new A("p","mm","a4"),y=190,w="../../../../fonts/arial.ttf";s.addFileToVFS("arial.ttf",w),s.setFont("arial"),s.setFontSize(12),H(o).then(a=>{const n=a.toDataURL("image/png"),k=a.height*y/a.width;s.addImage(n,"PNG",10,10,y,k);const m=s.internal.getNumberOfPages();for(let c=1;c<=m;c++){s.setPage(c);const x=`Page ${c} of ${m}`,P=12,g=s.internal.pageSize.getWidth()/2,t=s.internal.pageSize.getHeight()-10;s.setFontSize(P),s.text(x,g,t,{align:"center"})}s.save("rooznamchah.pdf")})}}},R={class:"row"},I={class:"col-12"},W={class:"card"},G={class:"card-body"},O=e("h4",{class:"card-title mb-4"},"جستجوی معامله",-1),X={class:"repeater",enctype:"multipart/form-data"},Y={class:"row"},J={class:"mb-3 col-md-2"},K=e("label",{for:"email"},"نوع معامله",-1),Z=e("option",{value:"all"},"همه",-1),$=e("option",{value:"rasid_bord"},"رسید و بردها",-1),ee=e("option",{value:"exchange"},"تبادلات",-1),te=e("option",{value:"transfer"},"انتقلات",-1),se=e("option",{value:"expense"},"مصارف",-1),oe=e("option",{value:"income"},"درآمدها",-1),ae=e("option",{value:"commission"},"کمیشن",-1),le=[Z,$,ee,te,se,oe,ae],ne={class:"mb-3 col-md-2"},ie=e("label",{for:"email"},"نوع رسید وبرد",-1),re=e("option",{value:"all"},"همه",-1),ce=e("option",{value:"rasid"},"رسید",-1),de=e("option",{value:"bord"},"برد",-1),_e=[re,ce,de],he={class:"mb-3 col-md-4 mt-4 p-2"},ue={class:"col-md-2 col-xs-12"},me=e("label",{for:"supplier"},"واحد پول :",-1),ge=e("option",{disabled:"",selected:""}," واحد",-1),pe=["value"],fe=e("span",{class:"text-danger error-text currency_error"},null,-1),be={class:"col-md-2 col-xs-12"},ve=e("label",{for:"supplier"},"انتخاب دخل : ",-1),ye=e("option",null,"ابتدا واحد پول را انتخاب کنید.",-1),ke=["value"],xe=e("span",{class:"text-danger error-text dakhl_error"},null,-1),Pe={class:"row"},we={class:"mb-3 col-lg-2"},Ce=e("label",{for:"email"},"تاریخ شروع",-1),Se={class:"mb-3 col-lg-2"},De=e("label",{for:"email"},"تاریخ ختم",-1),Le={class:"col-lg-1 align-self-center"},Ve={class:"d-grid"},ze=e("div",{class:"col-xl-4"},[e("div",{class:"card"})],-1),Fe={class:"col-xl-12"},Te={class:"card"},Me={class:"card-body"},Ue={class:"row"},Ee={class:"col-md-10"},Ne={class:"search-box me-2 mb-2 d-inline-block"},je={class:"position-relative"},Be=e("i",{class:"bx bx-search-alt search-icon"},null,-1),qe={class:"col-md-2 flex space-around"},Ae={class:"row"},He={class:"col-sm-12"},Qe={key:0},Re={key:1},Ie={key:0,class:"table-responsive"},We={class:"table table-centered table-nowrap text-start",ref:"table1"},Ge=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"تاریخ"),e("th",{class:"text-center"},"نوع تراکنش"),e("th",{class:"text-center"},"نام مشتری"),e("th",{class:"text-center"},"مقدار پول"),e("th",{class:"text-center"},"تفصیلات"),e("th",{class:"text-center"},"نمبر چک")])],-1),Oe={class:"text-center"},Xe={key:0},Ye={key:1},Je={key:0},Ke={key:1},Ze={class:"pagination pagination-rounded justify-content-center mb-2",style:{}},$e={class:"page-item"},et=["disabled"],tt=e("i",{class:"mdi mdi-chevron-left"},null,-1),st=[tt],ot={class:"page-link",href:"javascript: void(0);"},at={class:"page-item"},lt=["disabled"],nt=e("i",{class:"mdi mdi-chevron-right"},null,-1),it=[nt],rt={key:1,class:"text-center font-size-20"},ct=e("div",{class:"",style:{height:"50vh",display:"flex","flex-direction":"column","justify-content":"center"}}," تراکنشی برای نمایش وجود ندارد! ",-1),dt=[ct];function _t(o,s,y,w,a,n){const k=_("PageHeader"),m=_("v-select"),c=_("date-picker"),x=_("Loader"),P=_("Layout");return l(),T(P,null,{default:M(()=>{var g;return[h(k,{title:a.title,items:a.items},null,8,["title","items"]),e("div",R,[e("div",I,[e("div",W,[e("div",G,[O,e("form",X,[e("div",null,[e("div",Y,[e("div",J,[K,u(e("select",{class:"form-control form-control-lg required","onUpdate:modelValue":s[0]||(s[0]=t=>a.transaction_type=t)},le,512),[[f,a.transaction_type]])]),e("div",ne,[ie,u(e("select",{class:"form-control form-control-lg required","onUpdate:modelValue":s[1]||(s[1]=t=>a.rasid_bord=t)},_e,512),[[f,a.rasid_bord]])]),e("div",he,[h(m,{name:"customerName",modelValue:a.selectedCustomer,"onUpdate:modelValue":s[2]||(s[2]=t=>a.selectedCustomer=t),options:a.customers,label:"name",placeholder:"مشتری مورد نظر خود را سرچ کنید",class:"searchCustomer"},null,8,["modelValue","options"])]),e("div",ue,[me,u(e("select",{class:"form-control form-control-lg select2 required",onChange:s[3]||(s[3]=(...t)=>n.change_currency&&n.change_currency(...t)),"onUpdate:modelValue":s[4]||(s[4]=t=>a.currencyModel=t)},[ge,(l(!0),i(v,null,b(a.currencies,t=>(l(),i("option",{key:t==null?void 0:t.id,value:t==null?void 0:t.id},r(t==null?void 0:t.name)+" "+r(t==null?void 0:t.sign),9,pe))),128))],544),[[f,a.currencyModel]]),fe]),e("div",be,[ve,u(e("select",{class:"form-control form-control-lg select2 required","onUpdate:modelValue":s[5]||(s[5]=t=>a.SelectedDakhl=t)},[ye,(l(!0),i(v,null,b(a.banks,t=>(l(),i("option",{key:t.id,value:t.id},r(t.account_name),9,ke))),128))],512),[[f,a.SelectedDakhl]]),xe])]),e("div",Pe,[e("div",we,[Ce,h(c,{modelValue:a.start_date,"onUpdate:modelValue":s[6]||(s[6]=t=>a.start_date=t),mode:"single",type:"date",locale:"fa",column:1,clearable:""},null,8,["modelValue"])]),e("div",Se,[De,h(c,{onSelect:n.select_end_date,mode:"single",type:"date",locale:"fa",column:1,clearable:""},null,8,["onSelect"])]),e("div",Le,[e("div",Ve,[e("input",{type:"button",class:"btn btn-primary btn-block",value:"جستجو",onClick:s[7]||(s[7]=(...t)=>n.filterRooznamchah&&n.filterRooznamchah(...t))})])])])])])])])]),ze,e("div",Fe,[e("div",Te,[e("div",Me,[e("div",Ue,[e("div",Ee,[e("div",Ne,[e("div",je,[u(e("input",{type:"text","onUpdate:modelValue":s[8]||(s[8]=t=>a.searchQuery=t),class:"form-control",placeholder:"جستجوی مشتری...",onInput:s[9]||(s[9]=(...t)=>n.searchData&&n.searchData(...t))},null,544),[[U,a.searchQuery]]),Be])])]),e("div",qe,[e("button",{class:"btn btn-primary",onClick:s[10]||(s[10]=(...t)=>n.exportToPDF&&n.exportToPDF(...t))},"خروجی گرفتن")])]),e("div",Ae,[e("div",He,[a.isLoading?(l(),i("div",Qe,[h(x)])):(l(),i("div",Re,[(g=a.transactions)!=null&&g.length?(l(),i("div",Ie,[e("table",We,[Ge,e("tbody",Oe,[(l(!0),i(v,null,b(a.transactions,t=>{var p,C,S,D,L;return l(),i("tr",{key:t==null?void 0:t.id},[e("td",null,r(t==null?void 0:t.date),1),e("td",null,[e("span",{class:V(["badge badge-pill badge-soft-success font-bold p-2",{"badge-soft-success":`${t.rasid_bord}`=="rasid","badge-soft-warning":`${t.rasid_bord}`=="bord"}])},r(n.displayTransactionType(t.transaction_type)),3)]),t.customer!=null?(l(),i("td",Xe,r((p=t.customer)==null?void 0:p.name),1)):(l(),i("td",Ye,r((C=t.finance_account)==null?void 0:C.account_name),1)),e("td",null,[E(r(t.amount.toLocaleString())+" "+r((S=t.tr_currency)==null?void 0:S.name)+" "+r(t.rasid_bord==="rasid"?"به":"از")+" ",1),(t==null?void 0:t.bank_account)!=null?(l(),i("span",Je,r((D=t.bank_account)==null?void 0:D.account_name),1)):(l(),i("span",Ke,r((L=t.finance_account)==null?void 0:L.account_name),1))]),e("td",null,r(t.desc),1),e("td",null,r(t.check_number),1)])}),128))])],512),e("ul",Ze,[e("li",$e,[e("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Previous",onClick:s[11]||(s[11]=(...t)=>n.prevPage&&n.prevPage(...t)),disabled:a.currentPage===1},st,8,et)]),(l(!0),i(v,null,b(a.totalPages,(t,p)=>(l(),i("li",{class:V(["page-item",{active:t===a.currentPage}]),key:p},[e("a",ot,r(t),1)],2))),128)),e("li",at,[e("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Next",onClick:s[12]||(s[12]=(...t)=>n.nextPage&&n.nextPage(...t)),disabled:a.currentPage===a.totalPages},it,8,lt)])])])):(l(),i("div",rt,dt))]))])])])])])])]}),_:1})}const vt=z(Q,[["render",_t]]);export{vt as default};
