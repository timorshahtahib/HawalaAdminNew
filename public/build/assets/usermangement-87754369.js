import{_ as L,L as S,a as u,c as R,w as m,r as _,o as r,b as d,d as e,e as x,f as E,g as c,v as p,h as i,t as n,i as h,j as k,k as g,F as P,l as U,n as M}from"../js/app2.js";import{P as j}from"./page-header-48f5a59e.js";import{L as B}from"./loader-7b01d283.js";import{S as D}from"./sweetalert2.all-8f9540fb.js";const Q={components:{Layout:S,PageHeader:j,Loader:B},data(){return{title:"مدیریت کاربران",items:[{text:"صفحه اصلی",href:"/"},{text:"مدیریت کاربران",active:!0}],showModal:!1,showeditModal:!1,isLoading:!1,notFound:!1,searchQuery:"",users:[],user:"",name:"",email:"",password:"",role:"",processing:!1,regError:null,nameError:null,emailError:null,passwordError:null,roleError:null,errors:{},editName:"",editEmail:"",editRole:"",editProcessing:!1,editError:null,editNameError:null,editEmailError:null,editroleError:null,editerrors:{},currentPage:1,totalPages:1,limit:10}},mounted(){this.getUser()},methods:{async getUser(l=1){this.isLoading=!0;try{const s=await u.get(`/user?page=${l}&limit=${this.limit}`);this.users=s.data.users.data,this.totalPages=s.data.users.last_page,this.currentPage=l}catch(s){console.log(s.message)}finally{this.isLoading=!1}},prevPage(){this.currentPage>1&&this.getUser(this.currentPage-1)},nextPage(){this.currentPage<this.totalPages&&this.getUser(this.currentPage+1)},openModal(){this.showModal=!0},openEditModal(){this.showeditModal=!0},showalert(l,s,v){D.fire({title:l,text:s,icon:v,confirmButtonText:"بستن"})},async register(){try{this.processing=!0;const l=await u.post("/register",{name:this.name,email:this.email,password:this.password,role:this.role});l.data!=null&&(l.data.status===!1?l.data.message!=null&&(this.errors=l.data.error,this.nameError=this.errors.name,this.emailError=this.errors.email,this.passwordError=this.errors.password,this.roleError=this.errors.role):(this.errors={},this.name="",this.email="",this.role="",this.showModal=!1,this.users.unshift(l.data.new_user),this.showalert("کاربر با موفقیت ثبت شد!","","success")))}catch(l){console.log(l.message)}finally{this.processing=!1}},async updateUser(l){try{this.editProcessing=!0;const s=await u.get(`/user/${l}`);this.user=s.data,this.openEditModal(),this.editName=this.user.name,this.editEmail=this.user.email,this.editRole=this.user.role}catch(s){console.log(s.message)}},async submitUpdateUser(l){try{const s=await u.post("/updateuser",{id:this.user.id,name:this.editName,email:this.editEmail,role:this.editRole});s.data!=null&&(s.data.status===!1?s.data.message!=null?this.showalert(s.data.message,"error","error"):(this.errors=s.data.error,console.log("Errors",this.errors),console.log("status false")):(this.editerrors={},this.editName="",this.editEmail="",this.editrole="",this.showeditModal=!1,this.getUser(),this.showalert("حساب با موفقبت ویرایش شد","","success")))}catch(s){console.log(s),this.showalert("حساب با موفقیت ویرایش نشد!","","error")}},async deleteUser(l){if(window.confirm("آیا میخواهید که حساب حذف شود؟"))try{const s=await u.post("/deleteuser",{id:l});this.financeAccounts=s.data,s.status===204&&(this.showalert("حساب با موفقیت حذف شد!","موفقانه","success"),this.getUser())}catch{this.showalert("حساب با موفقیت حذف نشد!","ناموفقانه","error")}else return},async searchData(){await u.post("/searchUser",{query:this.searchQuery}),console.log("search")}}},z={class:"row"},F={class:"col-sm-8"},H={class:"text-sm-end"},T={class:"form-group mb-3"},q=e("label",{id:"email-group",label:"","label-for":"name"},"نام",-1),A={key:0,class:"pt-2 text-danger"},I={class:"form-group mt-2"},G=e("label",{id:"email-group","label-for":"ایمیل"},"ایمیل",-1),J={key:0,class:"pt-2 text-danger"},K={class:"row"},O={class:"col-md-12 col-sm-12 col-lg-12"},W={class:"mb-3"},X=e("label",{for:"editRo"},"تعین صلاحیت",-1),Y=e("option",{value:"",disabled:""},"انتخاب سطح دسترسی",-1),Z=e("option",{value:"customer"},"مشتری",-1),$=e("option",{value:"superadmin"},"سوپرادمین",-1),ee=e("option",{value:"admin"},"ادمین",-1),se=[Y,Z,$,ee],te={class:"text-end pt-5 mt-1 g-2"},oe={class:"col-xl-12"},le={class:"card",style:{"min-height":"100vh"}},re={class:"card-body"},ie={class:"row"},ae={class:"col-md-10"},ne={class:"search-box me-2 mb-2 d-inline-block"},de={class:"position-relative"},ce=e("i",{class:"bx bx-search-alt search-icon"},null,-1),me={class:"col-md-2 flex space-around"},he={class:"col-sm-12"},ue={class:"text-sm-end"},pe=e("i",{class:"mdi mdi-plus me-1"},null,-1),_e={key:0,class:"alert text-center text-black font-bold alert-danger",role:"alert"},ge={class:"form-group mb-3"},fe=e("label",{id:"email-group",label:"","label-for":"name"},"نام",-1),be={key:0,class:"pt-2 text-danger"},ve={class:"form-group mt-2"},ye=e("label",{id:"email-group","label-for":"ایمیل"},"ایمیل",-1),we={key:0,class:"pt-2 text-danger"},xe={class:"form-group mb-3"},Ee=e("label",{id:"password"},"رمز عبور",-1),ke={key:0,class:"pt-2 text-danger"},Pe={class:"row"},Ue={class:"col-md-12 col-sm-12 col-lg-12"},Me={class:"mb-3"},Ve=e("label",{for:"role"},"تعین صلاحیت",-1),Ne=e("option",{value:"",disabled:""},"انتخاب سطح دسترسی",-1),Ce=e("option",{value:"customer"},"مشتری",-1),Le=e("option",{value:"superadmin"},"سوپرادمین",-1),Se=e("option",{value:"admin"},"ادمین",-1),Re=[Ne,Ce,Le,Se],je={key:0,class:"pt-2 text-danger"},Be={class:"text-end pt-5 mt-1 g-2"},De={class:"row"},Qe={class:"col-sm-12"},ze={key:0},Fe={key:1},He={key:0,class:"table-responsive"},Te={class:"table table-centered table-nowrap text-start"},qe=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"آیدی"),e("th",{class:"text-center"},"نام"),e("th",{class:"text-center"},"ایمیل"),e("th",{class:"text-center"},"وضیعت"),e("th",{class:"text-center"},"سطح دسترسی"),e("th",{class:"text-center"},"اکشن")])],-1),Ae={class:"text-center"},Ie={class:"btn btn-xs"},Ge=["onClick"],Je={class:"btn btn-xs"},Ke=["onClick"],Oe={class:"pagination pagination-rounded justify-content-center mb-2",style:{}},We={class:"page-item"},Xe=["disabled"],Ye=e("i",{class:"mdi mdi-chevron-left"},null,-1),Ze=[Ye],$e={class:"page-link",href:"javascript: void(0);"},es={class:"page-item"},ss=["disabled"],ts=e("i",{class:"mdi mdi-chevron-right"},null,-1),os=[ts],ls={key:1,class:"text-center font-size-20"};function rs(l,s,v,is,o,a){const V=_("PageHeader"),f=_("b-button"),y=_("b-modal"),N=_("Loader"),C=_("Layout");return r(),R(C,null,{default:m(()=>{var w;return[d(V,{title:o.title,items:o.items},null,8,["title","items"]),e("div",z,[e("div",F,[e("div",H,[d(y,{modelValue:o.showeditModal,"onUpdate:modelValue":s[5]||(s[5]=t=>o.showeditModal=t),title:"ویرایش کاربر","title-class":"text-black font-18","body-class":"p-3","hide-footer":""},{default:m(()=>[e("form",{onSubmit:s[4]||(s[4]=x((...t)=>a.submitUpdateUser&&a.submitUpdateUser(...t),["prevent"]))},[E(l.$slots,"default"),e("div",T,[q,c(e("input",{type:"text",id:"editName",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>o.editName=t),placeholder:"نام..."},null,512),[[p,o.editName]]),o.editNameError?(r(),i("p",A,n(o.editNameError[0]),1)):h("",!0)]),e("div",I,[G,c(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.editEmail=t),type:"email",placeholder:"example@gmail.com",class:"form-control"},null,512),[[p,o.editEmail]]),o.editEmailError?(r(),i("p",J,n(o.editEmailError[0]),1)):h("",!0)]),e("div",K,[e("div",O,[e("div",W,[X,c(e("select",{class:"form-control form-control-lg","onUpdate:modelValue":s[2]||(s[2]=t=>o.editRole=t)},se,512),[[k,o.editRole]])])])]),e("div",te,[d(f,{type:"submit",disabled:o.processing,variant:"primary",class:"btn-block m-2"},{default:m(()=>[g(" آپدیت ")]),_:1},8,["disabled"]),d(f,{variant:"danger",onClick:s[3]||(s[3]=t=>o.showeditModal=!1)},{default:m(()=>[g("بستن")]),_:1})])],32)]),_:3},8,["modelValue"])])]),e("div",oe,[e("div",le,[e("div",re,[e("div",ie,[e("div",ae,[e("div",ne,[e("div",de,[c(e("input",{type:"text","onUpdate:modelValue":s[6]||(s[6]=t=>o.searchQuery=t),class:"form-control",placeholder:"جستجوی کاربر...",onInput:s[7]||(s[7]=(...t)=>a.searchData&&a.searchData(...t))},null,544),[[p,o.searchQuery]]),ce])])]),e("div",me,[e("div",he,[e("div",ue,[e("button",{type:"button",class:"btn btn-success btn-rounded mb-2 me-2",onClick:s[8]||(s[8]=(...t)=>a.openModal&&a.openModal(...t))},[pe,g("کاربر جدید ")]),d(y,{modelValue:o.showModal,"onUpdate:modelValue":s[15]||(s[15]=t=>o.showModal=t),title:"اضافه کردن کاربر جدید","title-class":"text-black font-18","body-class":"p-3","hide-footer":""},{default:m(()=>[o.regError?(r(),i("div",_e,[e("span",null,n(o.regError),1)])):h("",!0),e("form",{onSubmit:s[14]||(s[14]=x((...t)=>a.register&&a.register(...t),["prevent"]))},[E(l.$slots,"default"),e("div",ge,[fe,c(e("input",{type:"text",id:"name",class:"form-control","onUpdate:modelValue":s[9]||(s[9]=t=>o.name=t),placeholder:"نام..."},null,512),[[p,o.name]]),o.errors.name?(r(),i("p",be,n(o.nameError[0]),1)):h("",!0)]),e("div",ve,[ye,c(e("input",{"onUpdate:modelValue":s[10]||(s[10]=t=>o.email=t),type:"email",placeholder:"example@gmail.com",class:"form-control"},null,512),[[p,o.email]]),o.errors.email?(r(),i("p",we,n(o.emailError[0]),1)):h("",!0)]),e("div",xe,[Ee,c(e("input",{type:"password","onUpdate:modelValue":s[11]||(s[11]=t=>o.password=t),placeholder:"رمز عبور...",class:"form-control"},null,512),[[p,o.password]]),o.errors.password?(r(),i("p",ke,n(o.passwordError[0]),1)):h("",!0)]),e("div",Pe,[e("div",Ue,[e("div",Me,[Ve,c(e("select",{class:"form-control form-control-lg","onUpdate:modelValue":s[12]||(s[12]=t=>o.role=t)},Re,512),[[k,o.role]]),o.errors.role?(r(),i("p",je,n(o.roleError[0]),1)):h("",!0)])])]),e("div",Be,[d(f,{type:"submit",disabled:o.processing,variant:"primary",class:"btn-block m-2"},{default:m(()=>[g(n(o.processing?"لطفا منتظر باشید...":"ثبت نام"),1)]),_:1},8,["disabled"]),d(f,{variant:"danger",onClick:s[13]||(s[13]=t=>o.showModal=!1)},{default:m(()=>[g("بستن")]),_:1})])],32)]),_:3},8,["modelValue"])])])])]),e("div",De,[e("div",Qe,[o.isLoading?(r(),i("div",ze,[d(N)])):(r(),i("div",Fe,[(w=o.users)!=null&&w.length?(r(),i("div",He,[e("table",Te,[qe,e("tbody",Ae,[(r(!0),i(P,null,U(o.users,t=>(r(),i("tr",{key:t==null?void 0:t.id},[e("td",null,n(t.id),1),e("td",null,n(t.name),1),e("td",null,n(t.email),1),e("td",null,n(t.status),1),e("td",null,[e("span",{class:M(["badge font-size-14 font-bold p-1",t.role==="superadmin"?"bg-success":t.role==="admin"?"bg-primary":t.role==="user"?"bg-secondary":"bg-warning"])},n(t.role),3)]),e("td",null,[e("button",Ie,[e("i",{class:"fas fa-pencil-alt text-success me-1",onClick:b=>a.updateUser(t.id)},null,8,Ge)]),e("button",Je,[e("i",{class:"fas fa-trash-alt text-danger me-1",onClick:b=>a.deleteUser(t.id)},null,8,Ke)])])]))),128))])]),e("ul",Oe,[e("li",We,[e("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Previous",onClick:s[16]||(s[16]=(...t)=>a.prevPage&&a.prevPage(...t)),disabled:o.currentPage===1},Ze,8,Xe)]),(r(!0),i(P,null,U(o.totalPages,(t,b)=>(r(),i("li",{class:M(["page-item",{active:t===o.currentPage}]),key:b},[e("a",$e,n(t),1)],2))),128)),e("li",es,[e("a",{class:"page-link",href:"javascript: void(0);","aria-label":"Next",onClick:s[17]||(s[17]=(...t)=>a.nextPage&&a.nextPage(...t)),disabled:o.currentPage===o.totalPages},os,8,ss)])])])):(r(),i("div",ls," نتیجه مورد نظر یافت نشد! "))]))])])])])])])]}),_:3})}const ms=L(Q,[["render",rs]]);export{ms as default};
